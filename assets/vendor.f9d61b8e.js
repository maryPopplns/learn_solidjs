let Q=G;const b={},w=1,E=2,L={owned:null,cleanups:null,context:null,owner:null};var u=null;let C=null,h=null,d=null,r=null,p=null,N=0;function V(e,s){s&&(u=s);const t=h,l=u,i=e.length===0?L:{owned:null,cleanups:null,context:null,owner:l};u=i,h=null;try{return m(()=>e(()=>B(i)),!0)}finally{h=t,u=l}}function T(e,s,t){const l=K(e,s,!1,w);I(l)}function W(e){if(d)return e();let s;const t=d=[];try{s=e()}finally{d=null}return m(()=>{for(let l=0;l<t.length;l+=1){const i=t[l];if(i.pending!==b){const o=i.pending;i.pending=b,P(i,o)}}},!1),s}function j(e){let s,t=h;return h=null,s=e(),h=t,s}function P(e,s,t){if(e.comparator&&e.comparator(e.value,s))return s;if(d)return e.pending===b&&d.push(e),e.pending=s,s;let l=!1;return e.value=s,e.observers&&e.observers.length&&m(()=>{for(let i=0;i<e.observers.length;i+=1){const o=e.observers[i];l&&C.disposed.has(o),o.pure?r.push(o):p.push(o),o.observers&&(l&&!o.tState||!l&&!o.state)&&O(o),l||(o.state=w)}if(r.length>1e6)throw r=[],new Error},!1),s}function I(e){if(!e.fn)return;B(e);const s=u,t=h,l=N;h=u=e,J(e,e.value,l),h=t,u=s}function J(e,s,t){let l;try{l=e.fn(s)}catch(i){q(i)}(!e.updatedAt||e.updatedAt<=t)&&(e.observers&&e.observers.length?P(e,l):e.value=l,e.updatedAt=t)}function K(e,s,t,l=w,i){const o={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:s,owner:u,context:null,pure:t};return u===null||u!==L&&(u.owned?u.owned.push(o):u.owned=[o]),o}function R(e){const s=C;if(e.state!==w)return e.state=0;if(e.suspense&&j(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<N);)(e.state||s)&&t.push(e);for(let l=t.length-1;l>=0;l--)if(e=t[l],e.state===w||s)I(e);else if(e.state===E||s){const i=r;r=null,M(e,t[0]),r=i}}function m(e,s){if(r)return e();let t=!1;s||(r=[]),p?t=!0:p=[],N++;try{return e()}catch(l){q(l)}finally{X(t)}}function X(e){r&&(G(r),r=null),!e&&(p.length?W(()=>{Q(p),p=null}):p=null)}function G(e){for(let s=0;s<e.length;s++)R(e[s])}function M(e,s){e.state=0;const t=C;for(let l=0;l<e.sources.length;l+=1){const i=e.sources[l];i.sources&&(i.state===w||t?i!==s&&R(i):(i.state===E||t)&&M(i,s))}}function O(e){const s=C;for(let t=0;t<e.observers.length;t+=1){const l=e.observers[t];(!l.state||s)&&(l.state=E,l.pure?r.push(l):p.push(l),l.observers&&O(l))}}function B(e){let s;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),l=e.sourceSlots.pop(),i=t.observers;if(i&&i.length){const o=i.pop(),n=t.observerSlots.pop();l<i.length&&(o.sourceSlots[n]=l,i[l]=o,t.observerSlots[l]=n)}}if(e.owned){for(s=0;s<e.owned.length;s++)B(e.owned[s]);e.owned=null}if(e.cleanups){for(s=0;s<e.cleanups.length;s++)e.cleanups[s]();e.cleanups=null}e.state=0,e.context=null}function q(e){throw e}function v(e,s,t){let l=t.length,i=s.length,o=l,n=0,f=0,x=s[i-1].nextSibling,g=null;for(;n<i||f<o;){if(s[n]===t[f]){n++,f++;continue}for(;s[i-1]===t[o-1];)i--,o--;if(i===n){const c=o<l?f?t[f-1].nextSibling:t[o-f]:x;for(;f<o;)e.insertBefore(t[f++],c)}else if(o===f)for(;n<i;)(!g||!g.has(s[n]))&&s[n].remove(),n++;else if(s[n]===t[o-1]&&t[f]===s[i-1]){const c=s[--i].nextSibling;e.insertBefore(t[f++],s[n++].nextSibling),e.insertBefore(t[--o],c),s[i]=t[o]}else{if(!g){g=new Map;let a=f;for(;a<o;)g.set(t[a],a++)}const c=g.get(s[n]);if(c!=null)if(f<c&&c<o){let a=n,S=1,D;for(;++a<i&&a<o&&!((D=g.get(s[a]))==null||D!==c+S);)S++;if(S>c-f){const H=s[n];for(;f<c;)e.insertBefore(t[f++],H)}else e.replaceChild(t[f++],s[n++])}else n++;else s[n++].remove()}}}function Z(e,s,t){let l;return V(i=>{l=i,s===document?e():Y(s,e(),s.firstChild?null:void 0,t)}),()=>{l(),s.textContent=""}}function _(e,s,t){const l=document.createElement("template");l.innerHTML=e;let i=l.content.firstChild;return t&&(i=i.firstChild),i}function Y(e,s,t,l){if(t!==void 0&&!l&&(l=[]),typeof s!="function")return A(e,s,l,t);T(i=>A(e,s(),i,t),l)}function A(e,s,t,l,i){for(;typeof t=="function";)t=t();if(s===t)return t;const o=typeof s,n=l!==void 0;if(e=n&&t[0]&&t[0].parentNode||e,o==="string"||o==="number")if(o==="number"&&(s=s.toString()),n){let f=t[0];f&&f.nodeType===3?f.data=s:f=document.createTextNode(s),t=y(e,t,l,f)}else t!==""&&typeof t=="string"?t=e.firstChild.data=s:t=e.textContent=s;else if(s==null||o==="boolean")t=y(e,t,l);else{if(o==="function")return T(()=>{let f=s();for(;typeof f=="function";)f=f();t=A(e,f,t,l)}),()=>t;if(Array.isArray(s)){const f=[];if(U(f,s,i))return T(()=>t=A(e,f,t,l,!0)),()=>t;if(f.length===0){if(t=y(e,t,l),n)return t}else Array.isArray(t)?t.length===0?F(e,f,l):v(e,t,f):t==null||t===""?F(e,f):v(e,n&&t||[e.firstChild],f);t=f}else if(s instanceof Node){if(Array.isArray(t)){if(n)return t=y(e,t,l,s);y(e,t,null,s)}else t==null||t===""||!e.firstChild?e.appendChild(s):e.replaceChild(s,n?t:e.firstChild);t=s}}return t}function U(e,s,t){let l=!1;for(let i=0,o=s.length;i<o;i++){let n=s[i],f;if(n instanceof Node)e.push(n);else if(!(n==null||n===!0||n===!1))if(Array.isArray(n))l=U(e,n)||l;else if((f=typeof n)==="string")e.push(document.createTextNode(n));else if(f==="function")if(t){for(;typeof n=="function";)n=n();l=U(e,Array.isArray(n)?n:[n])||l}else e.push(n),l=!0;else e.push(document.createTextNode(n.toString()))}return l}function F(e,s,t){for(let l=0,i=s.length;l<i;l++)e.insertBefore(s[l],t)}function y(e,s,t,l){if(t===void 0)return e.textContent="";const i=l||document.createTextNode("");if(s.length){let o=!1;for(let n=s.length-1;n>=0;n--){const f=s[n];if(i!==f){const x=f.parentNode===e;!o&&!n?x?e.replaceChild(i,f):e.insertBefore(i,t):x&&f.remove()}else o=!0}}else s instanceof Node?e.replaceChild(i,s):e.insertBefore(i,t);return[i]}export{Z as r,_ as t};
